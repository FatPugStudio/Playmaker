using UnityEngine;

namespace HutongGames.PlayMaker.Actions {

    public class UBHStartShotRoutine : ComponentAction<UbhShotCtrl>
    {
        [RequiredField]
        [CheckForComponent (typeof (UbhShotCtrl))]
        [Tooltip ("The GameObject with UbhBullet component")]
        public FsmOwnerDefault gameObject;

        public override void Reset ()

        {
            gameObject = null;
        }

        public override void OnEnter () {

            StartShot ();
            Finish ();
        }

        void StartShot ()

        {

            var go = Fsm.GetOwnerDefaultTarget (gameObject);
            
            if (!UpdateCache (go))

            {
                return;
            }

            var ubh = go.GetComponent<UbhShotCtrl> ();

            if (ubh == null)

            {
                Debug.LogError ("No UbhShotCtrl component found in the gameObject: " + go.name);
            }

            if (ubh != null)

            {
                ubh.StartShotRoutine ();
                Finish ();
            }

        }
    }
}
