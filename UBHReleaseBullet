using UnityEngine;

namespace HutongGames.PlayMaker.Actions {

	public class UBHReleaseBullet : ComponentAction<UbhShotCtrl>

		{

			[RequiredField]
			[CheckForComponent (typeof (UbhShotCtrl))]
			[Tooltip ("The GameObject with UbhBullet component")]
			public FsmOwnerDefault gameObject;

			public override void Reset ()

			{
				gameObject = null;
			}

			public override void OnEnter ()

			{

				ReleaseBullet ();
				Finish ();

			}

			void ReleaseBullet ()

			{

				var go = Fsm.GetOwnerDefaultTarget (gameObject);
				if (!UpdateCache (go))

				{
					return;

				}

				var ubhbullet = go.GetComponent<UbhBullet> ();

				if (ubhbullet == null)

				{

					Debug.LogError ("No UbhBullet component found in the gameObject: " + go.name);

				}

				if (ubhbullet != null)

				{

					UbhObjectPool.instance.ReleaseBullet (ubhbullet, false);

				}

			}
		}

}
